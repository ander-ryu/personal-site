<!DOCTYPE html>
<html lang="zh">

<head>
  <meta charset="UTF-8">
  <title>个人履历</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>

<body>
  <h1>个人履历</h1>
  <nav>
    <a href="/">网站首页</a>
    <a href="/resume.html">个人履历</a>
    <a href="/projects.html">过去项目</a>
    <a href="/hobby.html">未来兴趣</a>
    <a href="/contact.html">联系方式</a>
    <a href="/display.html">数据展示</a>
    <a href="/upload.html">后台管理</a>
  </nav>

  <table id="resume_data">
    <thead>
      <tr>
        <th>年份</th>
        <th>月份</th>
        <th>经历</th>
        <th>备注</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <p id="loading">正在加载中...</p>

  <script>
    const SUPABASE_URL = window.env?.NEXT_PUBLIC_SUPABASE_URL || "https://你的项目ID.supabase.co";
    const SUPABASE_KEY = window.env?.NEXT_PUBLIC_SUPABASE_ANON_KEY || "你的 anon 公钥";
    const supabase = window.Supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    async function loadResume() {
      const { data, error } = await supabase
        .from("resume_data")
        .select("*")
        .order("year", { ascending: true })
        .order("month", { ascending: true });

      if (error) {
        console.error("加载失败:", error);
        return;
      }

      const tbody = document.querySelector("#resumeTable tbody");
      tbody.innerHTML = "";

      data.forEach(row => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${row.year}</td>
          <td>${row.month.toString().padStart(2, "0")}</td>
          <td>${row.experience}</td>
          <td>${row.note || "-"}</td>
        `;
        tbody.appendChild(tr);

      });
    }

    loadResume();
  </script>
</body>

</html>
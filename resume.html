<!DOCTYPE html>
<html lang="zh">

<head>
  <meta charset="UTF-8">
  <title>个人履历</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <h1>个人履历</h1>

  <nav>
    <a href="/">网站首页</a>
    <a href="/resume.html">个人履历</a>
    <a href="/projects.html">过去项目</a>
    <a href="/hobby.html">未来兴趣</a>
    <a href="/contact.html">联系方式</a>
    <a href="/display.html">数据展示</a>
    <a href="/upload.html">后台管理</a>
  </nav>

  <table>
    <thead>
      <tr>
        <th>年份</th>
        <th>月份</th>
        <th>经历</th>
        <th>备注</th>
      </tr>
    </thead>
    <tbody id="resume-body"></tbody>
  </table>

  <p id="loading">正在加载中...</p>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    // === ✅ 改成你的项目 URL 和匿名 key ===
    const SUPABASE_URL = "https://你的项目ID.supabase.co";
    const SUPABASE_KEY = "你的 NEXT_PUBLIC_SUPABASE_ANON_KEY";

    const supabase = window.Supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    const tbody = document.getElementById("resume-body");
    const loading = document.getElementById("loading");

    async function loadResume() {
      loading.textContent = "正在加载中...";

      // ✅ 查询数据库
      const { data, error } = await supabase
        .from("resume_data")
        .select("*")
        .order("year", { ascending: true })
        .order("month", { ascending: true });

      if (error) {
        console.error(error);
        loading.textContent = "❌ 数据加载失败：" + error.message;
        return;
      }

      if (!data || data.length === 0) {
        loading.textContent = "暂无数据";
        return;
      }

      loading.textContent = ""; // 清除“正在加载中”
      data.forEach(row => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${row.year}</td>
          <td>${row.month.toString().padStart(2, "0")}</td>
          <td>${row.experience}</td>
          <td>${row.note || "-"}</td>
        `;
        tbody.appendChild(tr);
      });
    }

    loadResume();
  </script>
</body>

</html>